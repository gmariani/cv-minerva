!function(){var t=String.fromCharCode,i=Math.pow,r=(Math.min,Math.max,i(2,-23),!1);ByteArray=function(t,i){var r=this;void 0==t?(t=new ArrayBuffer(5242880),r.length=0):r.length=t.byteLength,r.position=0,r.endian=void 0!==i?i:ByteArray.BIG_ENDIAN,r._bitBuffer=null,r._bitPosition=8,r._buffer=t,r._dataview=new DataView(r._buffer);var e={readUnsignedByte:"readUI8",readUnsignedShort:"readUI16",readUnsignedInt:"readUI32",readByte:"readSI8",readShort:"readSI16",readInt:"readSI32",readBoolean:"readUI8",writeUnsignedByte:"writeUI8",writeUnsignedShort:"writeUI16",writeUnsignedInt:"writeUI32",writeByte:"writeSI8",writeShort:"writeSI16",writeInt:"writeSI32",writeBoolean:"writeUI8"};for(var n in e)r[n]=r[e[n]]},ByteArray.BIG_ENDIAN="bigEndian",ByteArray.LITTLE_ENDIAN="littleEndian",ByteArray.prototype={resizeBuffer:function(t){var i=new ArrayBuffer(t);new Int8Array(i).set(new Int8Array(this._buffer)),this._buffer=i,this._dataview=new DataView(i)},getBytesAvailable:function(){return this.length-this.position},seek:function(t,i){var r=this;return r.position=(i?0:r.position)+t,r.align(),r},readBytes:function(t){var i=(this.position+=t)-t;return this._dataview.slice(i,this.position)},writeBytes:function(t){var i,e;for(function(){if(r){for(var t=[],i=0,e=arguments.length;i<e;i++)arguments[i],t[i]=arguments[i];postMessage({type:"debug",message:t})}}("writeBytes",Array.isArray(t)),i=Array.isArray(t)?t:new Int8Array(t._dataview.buffer),e=0;e<t.length;e++)this.writeByte(i[e])},readByteAt:function(t){return this._dataview[t]},writeByteAt:function(t,i){this._dataview[t]=i},readSI8:function(){var t=this._dataview.getInt8(this.position);return this.position+=1,this.align(),t},writeSI8:function(t){var i=this._dataview.setInt8(this.position,parseInt(t));return this.position+=1,this.length+=1,this.align(),i},readSI16:function(t){var i=this._dataview.getInt16(this.position,t);return this.position+=2,this.align(),i},writeSI16:function(t,i){var r=this._dataview.setInt16(this.position,t,i);return this.position+=2,this.length+=2,this.align(),r},readSI32:function(t){var i=this._dataview.getInt32(this.position,t);return this.position+=4,this.align(),i},writeSI32:function(t,i){var r=this._dataview.setInt32(this.position,t,i);return this.position+=4,this.length+=4,this.align(),r},readUI8:function(){var t=this._dataview.getUint8(this.position);return this.position+=1,this.align(),t},writeUI8:function(t){var i=this._dataview.setUint8(this.position,parseInt(t));return this.position+=1,this.length+=1,this.align(),i},readUI16:function(t){var i=this._dataview.getUint16(this.position,t);return this.position+=2,this.align(),i},writeUI16:function(t,i){var r=this._dataview.setUint16(this.position,t,i);return this.position+=2,this.length+=2,this.align(),r},readUI32:function(t){var i=this._dataview.getUint32(this.position,t);return this.position+=4,this.align(),i},writeUI32:function(t,i){var r=this._dataview.setUint32(this.position,t,i);return this.position+=4,this.length+=4,this.align(),r},_readFixedPoint:function(t,r){return this.readSB(t)*i(2,-r)},readFixed:function(){return this._readFixedPoint(32,16)},readFixed8:function(){return this._readFixedPoint(16,8)},readFB:function(t){return this._readFixedPoint(t,16)},readFloat:function(t){var i=this._dataview.getFloat32(this.position,t);return this.position+=4,this.align(),i},writeFloat:function(t,i){var r=this._dataview.setFloat32(this.position,t,i);return this.position+=4,this.length+=4,this.align(),r},readDouble:function(t){var i=this._dataview.getFloat64(this.position,t);return this.position+=8,this.align(),i},writeDouble:function(t,i){var r=this._dataview.setFloat64(this.position,t,i);return this.position+=8,this.length+=8,this.align(),r},readEncodedU32:function(){for(var t=0,i=0;i<5;i++){var r=this.readByteAt(this.position++);if(t|=(127&r)<<7*i,!(128&r))break}return t},align:function(){this._bitPosition=8,this._bitBuffer=null},readUB:function(t,i){for(var r=this,e=0,n=0;n<t;n++)8==r._bitPosition&&(r._bitBuffer=r.readUI8(),r._bitPosition=0),i?e|=(r._bitBuffer&1<<r._bitPosition++?1:0)<<n:e=e<<1|(r._bitBuffer&128>>r._bitPosition++?1:0);return e},writeUB:function(t,i){if(0!=i){var r=this;for(0==r._bitPosition&&(r._bitPosition=8);i>0;){for(;r._bitPosition>0&&i>0;)0!=(t&1<<i-1)&&(r._bitBuffer=r._bitBuffer|1<<r._bitPosition-1),--i,--r._bitPosition;0==r._bitPosition&&(r.writeUI8(r._bitBuffer),r._bitBuffer=0,i>0&&(r._bitPosition=8))}}},readSB:function(t){if(!t)return 0;var i=this.readUB(t);return 1==i>>>t-1?-(1+(~i&-1>>>-t)):i},writeSB:function(t,i){writeUB(t|(t<0?2147483648:0)>>32-i,i)},readUTFChar:function(){var t,i,r,e;function n(){return this.position-=2,o()}function s(){return this.position-=1,o()}function o(){return String.fromCharCode(t+56320)}return(t=this.readUI8())<128?String.fromCharCode(t):t<194?o():t<224?128!=(192&(i=this.readUI8()))?s():String.fromCharCode((t<<6)+i-12416):t<240?128!=(192&(i=this.readUI8()))?s():224==t&&i<160?s():128!=(192&(r=this.readUI8()))?n():String.fromCharCode((t<<12)+(i<<6)+r-925824):t<245?128!=(192&(i=this.readUI8()))?s():240==t&&i<144?s():244==t&&i>=144?s():128!=(192&(r=this.readUI8()))?n():128!=(192&(e=this.readUI8()))?function(){return this.position-=3,o()}():String.fromCharCode((t<<18)+(i<<12)+(r<<6)+e-63447168):o()},writeUTFChar:function(t){var i=t.charCodeAt(0);if(i<128)this.writeUI8(i);else if(i<=2047)this.writeUI8(192+(i>>6)),this.writeUI8(128+(63&i));else if(i<=65535)this.writeUI8(224+(i>>12)),this.writeUI8(128+(i>>6&63)),this.writeUI8(128+(63&i));else{if(!(i<=1114111))throw error("writeUTFChar: Invalid char code");this.writeUI8(240+(i>>18)),this.writeUI8(128+(i>>12&63)),this.writeUI8(128+(i>>6&63)),this.writeUI8(128+(63&i))}},readUTFBytes:function(t,i){for(var r=[],e=this.position+t;this.position<e;)r.push(this.readUTFChar(i));return r.join("")},writeUTFBytes:function(t){for(var i=t.split(""),r=t.length;r--;)this.writeUTFChar(i.shift())},readUTF:function(){var t=this.readUI16();return this.readUTFBytes(t)},writeUTF:function(t){var i=this.position;this.writeUI16(t.length),this.writeUTFBytes(t);var r=this.position-i-2;this._dataview.setUint16(i,r)},readString:function(i,r){var e=this,n=e._dataview,s=null;if(void 0!=i)s=n.substr(e.position,i),e.position+=i;else{for(var o=[],a=e.length-e.position;a--;){var h,u,d=e.readByteAt(e.position++);if(!d)break;r?o.push(t(d)):d<128?o.push(t(d)):d>191&&d<224?(h=e.readByteAt(e.position++),o.push(t((31&d)<<6|63&h)),a--):(h=e.readByteAt(e.position++),u=e.readByteAt(e.position++),o.push(t((15&d)<<12|(63&h)<<6|63&u)),a-=2)}s=o.join("")}return s}}}();