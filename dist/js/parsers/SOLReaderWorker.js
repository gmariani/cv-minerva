!function(){importScripts("https://cdn.mariani.life/projects/minerva/js/lib/ByteArray.js","https://cdn.mariani.life/projects/minerva/js/lib/AMF0.js","https://cdn.mariani.life/projects/minerva/js/lib/AMF3.js");var e=new AMF0,t=new AMF3,n=!1;function a(){if(n){for(var e=[],t=0,a=arguments.length;t<a;t++)arguments[t],e[t]=arguments[t],t!=a-1&&", ";"\n",postMessage({type:"debug",message:e})}}var i={};i[-1]={name:"Header",func:r},i[2]={name:"LSO",func:function(n,a){this.header=new r(n);n.position;if("TCSO"!=n.readUTFBytes(4))throw"Missing TCSO signature, not a SOL file";n.readUTFBytes(6),this.header.fileName=n.readUTFBytes(n.readUnsignedShort()),this.header.amfVersion=n.readUnsignedInt(),0===this.header.amfVersion||3===this.header.amfVersion?"undefined"==this.header.fileName&&(this.header.fileName="[SOL Name not Set]"):this.header.fileName="[Unsupported SOL format]";if(0==this.header.amfVersion||3==this.header.amfVersion)for(this.body={};n.getBytesAvailable()>1&&n.position<this.header.contentLength;){var i,s="";3==this.header.amfVersion?(s=t.readString(n).value,i=t.readData(n)):(s=n.readUTF(),i=e.readData(n)),n.readUnsignedByte(),this.body[s]=i}}},i[3]={name:"FilePath",func:function(e,t){this.header=new r(e),this.filePath=e.readUTFBytes(e.readUnsignedShort(),!0)}};var s={Header:-1,LSO:2,FilePath:3};function r(e){if(e){var t=e.position;this.tagTypeAndLength=e.readUI16(),this.contentLength=63&this.tagTypeAndLength,63==this.contentLength&&(this.contentLength=e.readSI32()),this.type=this.tagTypeAndLength>>6,this.headerLength=e.position-t,this.tagLength=this.headerLength+this.contentLength,this.name=i[this.type]?i[this.type].name:"?"}}onmessage=function(n){var h,o=n.data.fileID,d=new ByteArray(n.data.text,ByteArray.BIG_ENDIAN);e.reset(),t.reset(),h=function(e){var t=e.position,n={},h=new r(e);for(e.position=t;h;){var o=i[h.type];if(o){var d="LOG - "+e.position+" - "+i[h.type].name+" ("+h.type+") - "+h.contentLength,g=new o.func(e,n);switch(a(d,g),h.type){case s.LSO:n.header=g.header,n.body=g.body;break;case s.FilePath:n.flex=g}0!=h.tagLength-(e.position-t)&&a("Error reading "+i[h.type].name+" tag! Start:"+t+" End:"+e.position+" BytesAvailable:"+(h.tagLength-(e.position-t)),g),e.seek(h.tagLength-(e.position-t))}else a("Unknown tag type",h.type),e.seek(h.tagLength);if(e.getBytesAvailable()<=0)break;t=e.position,h=new r(e),e.position=t}return n}(d),postMessage({fileID:o,data:h})}}();